<!doctype html>
<html lang="en">
  <head>
    <title></title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="./static/build.css" rel="stylesheet" />
    <script src="./static/htmx.js"></script>
  </head>
  <body>
    <div class="max-w-lg mx-auto">
      <h1 class="text-5xl font-bold text-center my-3 dark:text-white">Todo App</h1>

      <form hx-post="/postTodo">
        <div class="flex mb-4">
          <div class="relative w-full">
            <input type="text" name="todo" class="block p-2.5 w-full z-20 text-sm text-gray-900 bg-gray-50 rounded-e-lg border-s-gray-50 border-s-2 border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-s-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:border-blue-500" required />
            <button type="submit" class="absolute top-0 end-0 p-2.5 text-sm font-medium h-full text-white bg-blue-700 rounded-e-lg border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Submit</button>
          </div>
        </div>
      </form>

      {{ range .Todos }}
      <form action="/updateTodo" method="post">
        <div class="block mt-3 p-6 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-800 dark:border-gray-700 dark:hover:bg-gray-700">
          <input type="checkbox" name="done" {{ if .Done }} checked {{ end }} onchange="this.form.submit()" />
          <input type="hidden" name="todoID" value="{{ .ID }}" />
          <input type="text" name="todo" value="{{ .Todo }}" />
          <button type="submit">Update</button>
          <button type="button" onclick="confirmDelete('{{ .ID }}')">Delete</button>
        </div>
      </form>
      {{end}}
    </div>
  </body>
</html>
<script>
  function confirmDelete(todoID) {
    if (confirm("Are you sure you want to delete this todo?")) {
      // Submit a form with the todoID to delete
      var form = document.createElement("form")
      form.method = "POST"
      form.action = "/deleteTodo"

      var hiddenField = document.createElement("input")
      hiddenField.type = "hidden"
      hiddenField.name = "todoID"
      hiddenField.value = todoID

      form.appendChild(hiddenField)
      document.body.appendChild(form)
      form.submit()
    }
  }
</script>
